<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¬ë£Œí”½</title> <!-- 1. í˜ì´ì§€ ì œëª© í…ìŠ¤íŠ¸ ë³€ê²½ -->
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts (Inter + Orbit) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- 1. Inter í°íŠ¸ + Orbit í°íŠ¸ ë¡œë“œ -->
    <link href="https://fonts.googleapis.com/css2?family=Orbit&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Tailwind CSS ê¸°ë³¸ ì„¤ì • */
        body { font-family: 'Inter', sans-serif; } /* ê¸°ë³¸ í°íŠ¸ëŠ” Inter ìœ ì§€ */
        /* 1. Orbit í°íŠ¸ í´ë˜ìŠ¤ ì¶”ê°€ */
        .Orbit { font-family: 'Orbit', cursive; }

        /* --- â˜… 1. ìŠ¤í¬ë¡¤ ì»¨í…Œì´ë„ˆ ê¸°ì¤€ì  ì„¤ì • â˜… --- */
        .main-scroll-area {
            position: relative; /* ìì‹ ìš”ì†Œì˜ offsetTop ê³„ì‚° ê¸°ì¤€ì ì´ ë˜ë„ë¡ ì„¤ì • */
        }

        
        /* --- ê¸°ì¡´ ìŠ¤íƒ€ì¼ ìœ ì§€ --- */
        .horizontal-scroll-wrapper { display: flex; align-items: center; overflow: hidden; }
        .horizontal-scroll-buttons { display: flex; overflow-x: auto; -webkit-overflow-scrolling: touch; scrollbar-width: none; white-space: nowrap; padding-bottom: 8px; margin-left: 8px; }
        .horizontal-scroll-buttons::-webkit-scrollbar { display: none; }
        .tag-button { flex-shrink: 0; }
        .fixed-label { flex-shrink: 0; }
        .horizontal-scroll-content { display: flex; overflow-x: auto; scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch; scrollbar-width: none; scroll-behavior: smooth; }
        .horizontal-scroll-content::-webkit-scrollbar { display: none; }
        .recipe-card-container { flex: 0 0 auto; scroll-snap-align: start; width: 85%; max-width: 320px; }
        /* â˜…â˜…â˜… í™”ì‚´í‘œ ìŠ¤íƒ€ì¼ ì œê±° ë˜ëŠ” ì£¼ì„ ì²˜ë¦¬ â˜…â˜…â˜… (1) */
        /* .scroll-arrow { position: absolute; top: 50%; transform: translateY(-50%); background-color: rgba(255, 255, 255, 0.7); border-radius: 50%; width: 2.5rem; height: 2.5rem; display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 10; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: background-color 0.2s; }*/
        /* .scroll-arrow:hover { background-color: rgba(255, 255, 255, 0.9); }*/
        /* .scroll-arrow.left { left: 0.5rem; }*/
        /* .scroll-arrow.right { right: 0.5rem; }*/
        .card-content-grid { display: grid; grid-template-columns: 100px 1fr; gap: 1rem; }
        .sauce-details { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .sauce-details.open { max-height: 500px; transition: max-height 0.5s ease-in; }
        .channel-btn.active { background-color: theme('colors.indigo.600'); color: white; padding-left: 0.75rem; padding-right: 0.75rem; border-radius: 9999px; }
        /* ì¦ê²¨ì°¾ê¸° ê´€ë ¨ ìŠ¤íƒ€ì¼ ì œê±° ë˜ëŠ” ì£¼ì„ ì²˜ë¦¬ */



        
    </style>
</head>
<body class="bg-gray-100 flex flex-col h-screen">

    <div class="max-w-md w-full mx-auto bg-white rounded-lg shadow-md flex flex-col flex-1 overflow-hidden my-4">
        <!-- ìƒë‹¨ ê³ ì •: ì œëª©, ê²€ìƒ‰, í•„í„° -->
        <div class="px-6 pt-6 pb-2 border-b">
            <!-- 1. í˜ì´ì§€ ì œëª© í…ìŠ¤íŠ¸ ë³€ê²½ ë° í°íŠ¸ ì ìš© -->
            <h1 class="font-Orbit text-4xl font-bold text-center mb-6 text-gray-800">ì¬ë£Œí”½</h1> <!-- mb-6 -> mb-2 -->
            <!-- 4. ê²€ìƒ‰ì°½ Placeholder ë³€ê²½ -->
            <div class="mb-4">
                <input type="search" id="searchInput" placeholder="ëƒ‰ì¥ê³  ì† ì¬ë£Œë¥¼ ê²€ìƒ‰í•´ë³´ì„¸ìš”! (900+ ì‡¼ì¸  ëŒ€ê¸° ì¤‘ğŸ³)" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <!-- ì±„ë„ í•„í„° ì˜ì—­ -->
            <div class="horizontal-scroll-wrapper mt-4">
                 <!-- 5. ê³ ì • ë¼ë²¨ ì‚­ì œ, ë²„íŠ¼ ì˜ì—­ë§Œ ë‚¨ê¹€ -->
                 <div id="channelFilters" class="horizontal-scroll-buttons gap-2 w-full">
                     <span class="text-xs text-gray-500">ì±„ë„ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span>
                 </div>
            </div>
        </div>

        <!-- ìŠ¤í¬ë¡¤ ì˜ì—­ -->
        <!-- --- â˜… 2. ìŠ¤í¬ë¡¤ ì»¨í…Œì´ë„ˆì— ID ë° í´ë˜ìŠ¤ ì¶”ê°€ â˜… --- -->
        <div id="mainScrollArea" class="flex-1 overflow-y-auto px-6 pt-2 space-y-2 main-scroll-area">
            <p class="text-sm text-gray-700 text-center mb-1 px-4 py-2 bg-gray-100 rounded-md">ì¬ë£Œ í”½! ìš”ë¦¬ ì‚¬ì§„ ëˆ„ë¥´ë©´ ë ˆì‹œí”¼ ë“±ì¥ ğŸ¬</p>
            <!-- â˜…â˜…â˜… ì•ˆë‚´ ë¬¸êµ¬ ìˆ˜ì • ë â˜…â˜…â˜… -->

            <!-- ì¦ê²¨ì°¾ê¸° ì„¹ì…˜ ì£¼ì„ ì²˜ë¦¬ -->
            <!-- ... -->

            <!-- ì¶”ì²œ ìš”ë¦¬ ì„¹ì…˜ -->
            <section id="recommendations" class="relative"> <!-- ì•ˆë‚´ ë¬¸êµ¬ì™€ì˜ ê°„ê²©ì€ space-y-8ì— ì˜í•´ ì¡°ì ˆë¨ -->
                <div class="flex items-start justify-between mb-3"> 
                <h2 class="font-nanum-coding text-1xl font-semibold text-gray-700">ì¶”ì²œí”½ ì˜¤ëŠ˜ì˜ ìš”ë¦¬ ğŸ‘‰</h2>
                <!-- â˜…â˜…â˜… ë²„íŠ¼ í´ë˜ìŠ¤ ìˆ˜ì •: íŒ¨ë”© ì¶”ê°€ (í´ë¦­ ì˜ì—­ í™•ë³´) â˜…â˜…â˜… -->
                <button id="refreshRecommendations" title="ì¶”ì²œ ìƒˆë¡œê³ ì¹¨" class="text-gray-500 hover:text-blue-600 focus:outline-none p-1 rounded-full"> <!--{/* p-1, rounded-full ì¶”ê°€ !-->
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
                    </svg>
                </button>
            </div>
                <!-- â˜…â˜…â˜… í™”ì‚´í‘œ ë²„íŠ¼ ì œê±° â˜…â˜…â˜…(2) -->
                <div class="relative">
                    <div id="recommendationResults" class="horizontal-scroll-content space-x-4 pb-4">
                        <p class="text-gray-500 self-center w-full text-center">ì¶”ì²œ ë ˆì‹œí”¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
                    </div>
                    <!-- <button class="scroll-arrow left recommend-arrow-left" onclick="scrollSection('recommendationResults', -1)"> <svg class="w-6 h-6 text-gray-600"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg> </button> -->
                    <!-- <button class="scroll-arrow right recommend-arrow-right" onclick="scrollSection('recommendationResults', 1)"> <svg class="w-6 h-6 text-gray-600"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" /></svg> </button> -->
                </div>
            </section>

            <!-- ê²€ìƒ‰ ê²°ê³¼ ì„¹ì…˜ -->
            <section id="results" class="relative mt-8">
                 <!-- 3. ì„¹ì…˜ ì œëª© í…ìŠ¤íŠ¸ ë³€ê²½ ë° í°íŠ¸ ì ìš© -->
                <h2 id="searchResultsTitle" class="font-Orbit text-1xl font-semibold mb-10 text-gray-700">ì¬ë£Œí”½ ê²€ìƒ‰ ê²°ê³¼ğŸ‘‰</h2>
                <!-- â˜…â˜…â˜… í™”ì‚´í‘œ ë²„íŠ¼ ì œê±° â˜…â˜…â˜… (3)-->
                <div class="relative">
                    <div id="searchResults" class="horizontal-scroll-content space-x-4 pb-4">
                        <!-- 5. ë¡œë”© ë©”ì‹œì§€ ë³€ê²½ -->
                        <p class="text-gray-500 self-center w-full text-center">ì–´ë–¤ ì¬ë£Œë¡œ í”½í• ê¹Œìš”? ğŸğŸ¥‘ğŸ³</p>
                    </div>
                    <!-- <button class="scroll-arrow left search-arrow-left" onclick="scrollSection('searchResults', -1)"> <svg class="w-6 h-6 text-gray-600"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg> </button> -->
                    <!-- <button class="scroll-arrow right search-arrow-right" onclick="scrollSection('searchResults', 1)"> <svg class="w-6 h-6 text-gray-600"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" /></svg> </button> -->
                </div>
            </section>
        </div>
    </div> <footer class="text-center px-4 pt-2 pb-4 mt-auto">
        <p class="text-[10px] text-gray-500 leading-relaxed">
            â€˜ì¬ë£Œí”½â€™ì€ AI/Ops ê¸°ë°˜ ê°œì¸ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.
            <br>
            <a href="https://allesgute965.notion.site/29ab103176b2801b8b66fd5a03ac8cbf" target="_blank" 
               class="text-black-600 font-medium mx-1 group">
                ì œì‘ ê³¼ì •ê³¼ ë¬¸ì œ í•´ê²° ìŠ¤í† ë¦¬ëŠ” ğŸ‘‰ 
               <span class="group-hover:underline">Notion</span>
            </a>
        </p>
    </footer>

    <script>
        const searchInput = document.getElementById('searchInput');
        const searchResultsDiv = document.getElementById('searchResults');
        const recommendationResultsDiv = document.getElementById('recommendationResults');
        const channelFiltersDiv = document.getElementById('channelFilters');

        let selectedChannelId = null;

        // --- ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ (createRecipeCard ì¬í™•ì¸: ë”ë³´ê¸° ì—†ìŒ) ---
         function createRecipeCard(recipe) {
            const videoUrl = `https://www.youtube.com/watch?v=${recipe.video_id}`;
            const thumbnailUrl = `https://i.ytimg.com/vi/${recipe.video_id}/mqdefault.jpg`;

            // --- â–¼â–¼â–¼ ë³€ìˆ˜ ì´ˆê¸°í™” â–¼â–¼â–¼ ---
            let mainIngredientsHtml = '<li class="text-sm text-gray-500 italic">ì£¼ìš” ì¬ë£Œ ì •ë³´ ì—†ìŒ</li>'; // ê¸°ë³¸ê°’ ì„¤ì •
            let sauceIngredientsHtml = '';
            let sauceToggleHtml = '';
            // --- â–²â–²â–² ë³€ìˆ˜ ì´ˆê¸°í™” â–²â–²â–² ---

            try {
                const ingredientsJsonString = recipe.ai_ingredients;
                let ingredientsData = {};
                if (ingredientsJsonString && typeof ingredientsJsonString === 'string' && ingredientsJsonString.trim().startsWith('{')) {
                     ingredientsData = JSON.parse(ingredientsJsonString);
                }

                // --- â–¼â–¼â–¼ mainList ì²˜ë¦¬ (ë”ë³´ê¸° ì—†ìŒ) â–¼â–¼â–¼ ---
                const mainList = ingredientsData.main || [];
                if (mainList.length > 0) {
                    // ì „ì²´ ëª©ë¡ìœ¼ë¡œ mainIngredientsHtml ìƒì„±
                    mainIngredientsHtml = mainList.map(item => `<li class="text-sm text-gray-600 truncate">${item}</li>`).join('');
                }
                // (else ë¶€ë¶„ì€ ì´ˆê¸°ê°’ìœ¼ë¡œ ì²˜ë¦¬ë¨)
                // --- â–²â–²â–² mainList ì²˜ë¦¬ ë â–²â–²â–² ---

                // ì†ŒìŠ¤ ëª©ë¡ ì²˜ë¦¬ (ë™ì¼)
                const sauceList = ingredientsData.sauce || [];
                if (sauceList.length > 0) {
                    sauceIngredientsHtml = sauceList.map(item => `<li class="text-sm text-gray-600 truncate">${item}</li>`).join('');
                    sauceToggleHtml = `
                        <button onclick="toggleSauce(this)" class="mt-2 text-sm text-black-600 hover:text-black-800 focus:outline-none">
                            ì†ŒìŠ¤ ë³´ê¸° â–¼
                        </button>
                        <div class="sauce-details ml-4 mt-1 border-l-2 border-blue-200 pl-3">
                            <ul class="list-disc list-inside">${sauceIngredientsHtml}</ul>
                        </div>
                    `;
                }
            } catch (e) {
                 console.error(`[${recipe.video_id}] Failed to parse ai_ingredients JSON:`, recipe.ai_ingredients, e);
                 // ì˜¤ë¥˜ ì‹œ í‘œì‹œë  ë©”ì‹œì§€
                 mainIngredientsHtml = '<li class="text-sm text-red-500 italic">ì¬ë£Œ ì •ë³´ ì²˜ë¦¬ ì˜¤ë¥˜</li>';
            }

            const cardContainer = document.createElement('div');
            cardContainer.className = 'recipe-card-container';
            cardContainer.innerHTML = `
                <div class="relative bg-gray-50 p-4 rounded-md border border-gray-200 shadow-sm h-full flex flex-col">
                    <h3 class="font-semibold text-md mb-2 text-gray-800 truncate">${recipe.title || 'ì œëª© ì—†ìŒ'}</h3>
                    <div class="card-content-grid flex-1 overflow-hidden">
                        
                        <div class="flex flex-col">
                            <a href="${videoUrl}" target="_blank" class="block rounded overflow-hidden aspect-[9/16] mb-1"> 
                                <img src="${thumbnailUrl}" alt="${recipe.title || 'ë ˆì‹œí”¼ ì˜ìƒ ì¸ë„¤ì¼'}" class="w-full h-full object-cover" loading="lazy">
                            </a>
                        
                            <p class="text-[0.45rem] leading-tight text-gray-500 truncate text-left w-full"> 
                                ì¶œì²˜ ${recipe.channel_name || 'ì•Œ ìˆ˜ ì—†ìŒ'} (YouTube)
                            </p>
                        </div>
                        
                        <div class="overflow-y-auto text-sm pr-1">
                            <h4 class="font-medium text-gray-700 mb-1">ì¬ë£Œ:</h4>
                            <ul class="ingredient-list">
                                ${mainIngredientsHtml}
                            </ul>
                            ${sauceToggleHtml}
                        </div>
                        
                    </div>
                </div>
            `;
            return cardContainer;
        }

        function toggleSauce(button) {
             const detailsDiv = button.nextElementSibling;
             const isOpen = detailsDiv.classList.contains('open');
             detailsDiv.classList.toggle('open');
             button.textContent = isOpen ? 'ì†ŒìŠ¤ ë³´ê¸° â–¼' : 'ì†ŒìŠ¤ ì ‘ê¸° â–²';
        }

        // --- API í˜¸ì¶œ í•¨ìˆ˜ (fetchAndDisplay) ---
         async function fetchAndDisplay(url, targetDiv, placeholder) {
            targetDiv.innerHTML = `<p class="text-gray-500 self-center w-full text-center">${placeholder}</p>`;

            // --- ì œëª© ìš”ì†Œ ê°€ì ¸ì˜¤ê¸° (ê²€ìƒ‰ ê²°ê³¼ ì„¹ì…˜ë§Œ í•´ë‹¹) ---
            const searchTitleElement = document.getElementById('searchResultsTitle');

            try {
                const absoluteUrl = window.location.origin + url;
                const response = await fetch(absoluteUrl);
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const data = await response.json();
                console.log(`Data received for ${url}:`, data); // API ì‘ë‹µ ë°ì´í„° í™•ì¸

                targetDiv.innerHTML = '';

                // --- ê²€ìƒ‰ ê²°ê³¼ ìœ ë¬´ì— ë”°ë¼ ì œëª© ë§ˆì§„ ë³€ê²½ ---
                if (!Array.isArray(data) || data.length === 0) {
                     targetDiv.innerHTML = '<p class="text-gray-500 self-center w-full text-center">ì•—, ì´ë²ˆ ì¬ë£ŒëŠ” ì—†ì–´ìš”!<br>ë‹¤ë¥¸ ì¬ë£Œë¡œ í”½í•´ë³¼ê¹Œìš”? ğŸ¥šğŸ…ğŸ§ˆ</p>';
                     // ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ì„ ë•Œ -> í° ë§ˆì§„ ìœ ì§€
                     if (searchTitleElement && targetDiv === searchResultsDiv) {
                         searchTitleElement.classList.remove('mb-3');
                         searchTitleElement.classList.add('mb-20');
                     }
                } else {
                     if (url.startsWith('/api/channels')) {
                         loadChannelFilterButtons(data);
                     } else { // ê²€ìƒ‰ ë˜ëŠ” ì¶”ì²œ ê²°ê³¼
                         data.forEach(recipe => {
                             targetDiv.appendChild(createRecipeCard(recipe));
                         });
                         // ê²€ìƒ‰ ê²°ê³¼ê°€ ìˆì„ ë•Œ -> ì‘ì€ ë§ˆì§„ìœ¼ë¡œ ë³€ê²½
                         if (searchTitleElement && targetDiv === searchResultsDiv) {
                             searchTitleElement.classList.remove('mb-20');
                             searchTitleElement.classList.add('mb-3');
                         }
                         // --- â˜…â˜…â˜… 4. ì—¬ê¸°ì— ìë™ ìŠ¤í¬ë¡¤ ë¡œì§ ì¶”ê°€ â˜…â˜…â˜… ---
                          // (ì´ í•¨ìˆ˜ê°€ 'ê²€ìƒ‰ ê²°ê³¼' ì˜ì—­ì„ ì—…ë°ì´íŠ¸í•œ ê²½ìš°ì—ë§Œ ìŠ¤í¬ë¡¤)
                          if (targetDiv === searchResultsDiv) {
                              setTimeout(() => {
                                  const scrollContainer = document.getElementById('mainScrollArea');
                                  const resultsSection = document.getElementById('results');
                                  if (scrollContainer && resultsSection) {
                                      // ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ resultsSectionì˜ ìƒëŒ€ì  ìœ„ì¹˜ë¡œ ìŠ¤í¬ë¡¤
                                      scrollContainer.scrollTo({ 
                                          top: resultsSection.offsetTop - scrollContainer.offsetTop - 10, // -10px ì—¬ìœ  ê³µê°„
                                          behavior: 'smooth' 
                                      });
                                  }
                              }, 100); // ë Œë”ë§ì„ ìœ„í•´ 100ms ì§€ì—°
                          }
                          // --- â˜…â˜…â˜… ìë™ ìŠ¤í¬ë¡¤ ë¡œì§ ë â˜…â˜…â˜… ---
                        
                     }
                }
                
            } catch (error) {
                console.error('Fetch error:', error);
                targetDiv.innerHTML = `<p class="text-red-500 self-center w-full text-center">ì˜¤ë¥˜: ${error.message}</p>`;
                 // ì˜¤ë¥˜ ë°œìƒ ì‹œì—ë„ í° ë§ˆì§„ ìœ ì§€ (ì„ íƒ ì‚¬í•­)
                 if (searchTitleElement && targetDiv === searchResultsDiv) {
                     searchTitleElement.classList.remove('mb-3');
                     searchTitleElement.classList.add('mb-20');
                 }
                 // --- â˜…â˜…â˜… í™”ì‚´í‘œ ê´€ë ¨ í•¨ìˆ˜ í˜¸ì¶œ ì œê±°ë¨ â˜…â˜…â˜… ---
                 /*
                if (targetDiv === recommendationResultsDiv || targetDiv === searchResultsDiv) {
                   updateArrowVisibility(targetDiv.id); // <- í˜¸ì¶œ ì œê±°
                }
                */
            }
        }

        // --- ì±„ë„ ê´€ë ¨ í•¨ìˆ˜ (loadChannelFilterButtons, selectChannel, triggerSearch) ---
        function loadChannelFilterButtons(channels) {
            channelFiltersDiv.innerHTML = ''; // 'ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...' ì œê±°
            // 'All channels' ë²„íŠ¼ ì¶”ê°€
            const allButton = document.createElement('button');
            allButton.textContent = 'All channels';
            allButton.className = 'tag-button channel-btn active bg-indigo-600 text-white text-xs font-medium px-3 py-1 rounded-full focus:outline-none';
            allButton.onclick = () => selectChannel(null, allButton);
            channelFiltersDiv.appendChild(allButton);

            if (channels.length > 0) {
                channels.forEach(channel => {
                    const button = document.createElement('button');
                    button.textContent = channel.name;
                    button.className = 'tag-button channel-btn bg-gray-200 text-gray-800 text-xs font-medium px-3 py-1 rounded-full hover:bg-gray-300 focus:outline-none';
                    button.onclick = () => selectChannel(channel.id, button);
                    channelFiltersDiv.appendChild(button);
                });
            }
        }

        function selectChannel(channelId, clickedButton) {
            selectedChannelId = channelId;
            document.querySelectorAll('.channel-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-indigo-600', 'text-white');
                btn.classList.add('bg-gray-200', 'text-gray-800', 'hover:bg-gray-300');
            });
            clickedButton.classList.remove('bg-gray-200', 'text-gray-800', 'hover:bg-gray-300');
            clickedButton.classList.add('active', 'bg-indigo-600', 'text-white');
            triggerSearch(searchInput.value.trim()); // í˜„ì¬ í‚¤ì›Œë“œë¡œ ê²€ìƒ‰ ì¬ì‹¤í–‰
        }

        function triggerSearch(keyword) {
            let searchUrl = '/api/search';
            const params = new URLSearchParams();
            if (keyword) params.append('keyword', keyword);
            if (selectedChannelId) params.append('channel_id', selectedChannelId);
            const queryString = params.toString();
            if (queryString) searchUrl += `?${queryString}`;
            fetchAndDisplay(searchUrl, searchResultsDiv, 'ê²€ìƒ‰ ì¤‘...');

              // --- â˜…â˜…â˜… 3. ì—¬ê¸° ìˆë˜ setTimeout ë¸”ë¡ ì‚­ì œ â˜…â˜…â˜… ---


        }
        /* --- â˜…â˜…â˜… í™”ì‚´í‘œ ê´€ë ¨ í•¨ìˆ˜ ì œê±° ë˜ëŠ” ì£¼ì„ ì²˜ë¦¬ â˜…â˜…â˜…(6) --- */
        /*
        // --- í™”ì‚´í‘œ ìŠ¤í¬ë¡¤/í‘œì‹œ í•¨ìˆ˜ (scrollSection, updateArrowVisibility) ---
        function scrollSection(sectionId, direction) {
            const section = document.getElementById(sectionId);
            if (!section) return;
            const firstCard = section.querySelector('.recipe-card-container');
            let scrollAmount = section.offsetWidth * 0.8;
            if (firstCard) scrollAmount = firstCard.offsetWidth + 16;
            section.scrollBy({ left: scrollAmount * direction, behavior: 'smooth' });
        }

        function updateArrowVisibility(sectionId) {
            const section = document.getElementById(sectionId);
            const baseArrowClass = sectionId.replace('Results', '').toLowerCase();
            const leftArrow = document.querySelector(`.${baseArrowClass}-arrow-left`);
            const rightArrow = document.querySelector(`.${baseArrowClass}-arrow-right`);

            if (section && leftArrow && rightArrow) {
                const isScrollable = section.scrollWidth > section.clientWidth + 1;
                const hasContent = section.querySelector('.recipe-card-container') !== null;
                const showArrows = isScrollable && hasContent;

                leftArrow.style.display = showArrows ? 'flex' : 'none';
                rightArrow.style.display = showArrows ? 'flex' : 'none';

                if (showArrows) {
                    const maxScrollLeft = section.scrollWidth - section.clientWidth;
                    leftArrow.style.opacity = section.scrollLeft > 5 ? '1' : '0.3';
                    rightArrow.style.opacity = section.scrollLeft < maxScrollLeft - 5 ? '1' : '0.3';
                }
            } else {
                 if(leftArrow) leftArrow.style.display = 'none';
                 if(rightArrow) rightArrow.style.display = 'none';
            }
        }
        */

        // --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---
        searchInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
                triggerSearch(searchInput.value.trim());
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ
        document.addEventListener('DOMContentLoaded', () => {
            fetchAndDisplay('/api/recommendations', recommendationResultsDiv, 'ì¶”ì²œ ë ˆì‹œí”¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...');
            fetchAndDisplay('/api/channels', channelFiltersDiv, 'ì±„ë„ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...');

            const refreshButton = document.getElementById('refreshRecommendations');
            if (refreshButton) {
                 refreshButton.addEventListener('click', () => {
                    fetchAndDisplay('/api/recommendations', recommendationResultsDiv, 'ì¶”ì²œ ìƒˆë¡œê³ ì¹¨ ì¤‘...');
                });
            }
             // â˜…â˜…â˜… í™”ì‚´í‘œ ê´€ë ¨ ìŠ¤í¬ë¡¤ ë¦¬ìŠ¤ë„ˆ ì œê±° ë˜ëŠ” ì£¼ì„ ì²˜ë¦¬(7) â˜…â˜…â˜…
            //recommendationResultsDiv.addEventListener('scroll', () => updateArrowVisibility('recommendationResults'));
            //searchResultsDiv.addEventListener('scroll', () => updateArrowVisibility('searchResults'));
        });

    </script>
</body>
</html>

